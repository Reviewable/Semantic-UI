!function(y,C){y.fn.colorize=function(e){var b=y.extend(!0,{},y.fn.colorize.settings,e),v=arguments||!1;return y(this).each(function(e){var n,i,t,a,o,r,c,s=y(this),d=y("<canvas />")[0],g=y("<canvas />")[0],l=y("<canvas />")[0],u=new Image,m=b.colors,f=(b.paths,b.namespace),h=b.error,p=s.data("module-"+f),w={checkPreconditions:function(){return w.debug("Checking pre-conditions"),!(!y.isPlainObject(m)||y.isEmptyObject(m))||(w.error(h.undefinedColors),!1)},async:function(e){b.async?setTimeout(e,0):e()},getMetadata:function(){w.debug("Grabbing metadata"),a=s.data("image")||b.image||C,o=s.data("name")||b.name||e,r=b.width||s.width(),c=b.height||s.height(),0!==r&&0!==c||w.error(h.undefinedSize)},initialize:function(){w.debug("Initializing with colors",m),w.checkPreconditions()&&w.async(function(){w.getMetadata(),w.canvas.create(),w.draw.image(function(){w.draw.colors(),w.canvas.merge()}),s.data("module-"+f,w)})},redraw:function(){w.debug("Redrawing image"),w.async(function(){w.canvas.clear(),w.draw.colors(),w.canvas.merge()})},change:{color:function(e,n){if(w.debug("Changing color",e),m[e]===C)return w.error(h.missingColor),!1;m[e]=n,w.redraw()}},canvas:{create:function(){w.debug("Creating canvases"),d.width=r,d.height=c,g.width=r,g.height=c,l.width=r,l.height=c,n=d.getContext("2d"),i=g.getContext("2d"),t=l.getContext("2d"),s.append(d),n=s.children("canvas")[0].getContext("2d")},clear:function(e){w.debug("Clearing canvas"),t.fillStyle="#FFFFFF",t.fillRect(0,0,r,c)},merge:function(){y.isFunction(n.blendOnto)?(n.putImageData(i.getImageData(0,0,r,c),0,0),t.blendOnto(n,"multiply")):w.error(h.missingPlugin)}},draw:{image:function(e){w.debug("Drawing image"),e=e||function(){},a?(u.src=a,u.onload=function(){i.drawImage(u,0,0),e()}):(w.error(h.noImage),e())},colors:function(){w.debug("Drawing color overlays",m),y.each(m,function(e,n){b.onDraw(t,o,e,n)})}},debug:function(e,n){b.debug&&(n!==C?console.info(b.name+": "+e,n):console.info(b.name+": "+e))},error:function(e){console.warn(b.name+": "+e)},invoke:function(e,n,i){var t;return i=i||Array.prototype.slice.call(arguments,2),"string"==typeof e&&p!==C&&(e=e.split("."),y.each(e,function(e,n){return y.isPlainObject(p[n])?(p=p[n],!0):y.isFunction(p[n])?(t=p[n],!0):(w.error(b.error.method),!1)})),!!y.isFunction(t)&&t.apply(n,i)}};if(p!==C&&v)return"invoke"==v[0]&&(v=Array.prototype.slice.call(v,1)),w.invoke(v[0],this,Array.prototype.slice.call(v,1));w.initialize()}),this},y.fn.colorize.settings={name:"Image Colorizer",debug:!0,namespace:"colorize",onDraw:function(e,n,i,t){},async:!0,colors:{},metadata:{image:"image",name:"name"},error:{noImage:"No tracing image specified",undefinedColors:"No default colors specified.",missingColor:"Attempted to change color that does not exist",missingPlugin:"Blend onto plug-in must be included",undefinedHeight:"The width or height of image canvas could not be automatically determined. Please specify a height."}}}(jQuery,(window,void document));
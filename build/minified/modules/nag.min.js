!function(C,D,M){C.fn.nag=function(x){var T,S=C(this),A=S.selector||"",H=(new Date).getTime(),z=[],F=x,N="string"==typeof F,O=[].slice.call(arguments,1);return C(this).each(function(){var e,o,t,n,i,s,r,a,c=C.extend(!0,{},C.fn.nag.settings,x),l=c.className,d=c.selector,u=c.error,f=c.namespace,g="."+f,m=f+"-module",p=C(this),h=p.find(d.close),b=C(c.context),v=this,y=p.data(m),w=D.requestAnimationFrame||D.mozRequestAnimationFrame||D.webkitRequestAnimationFrame||D.msRequestAnimationFrame||function(e){setTimeout(e,0)},k={initialize:function(){k.verbose("Initializing element"),e=p.offset(),o=p.outerHeight(),t=b.outerWidth(),n=b.outerHeight(),i=b.offset(),p.data(m,k),h.on("click"+g,k.dismiss),c.context==D&&"fixed"==c.position&&p.addClass(l.fixed),c.sticky&&(k.verbose("Adding scroll events"),("absolute"==c.position?b:C(D)).on("scroll"+g,k.event.scroll).on("resize"+g,k.event.scroll),C.proxy(k.event.scroll,this)()),0<c.displayTime&&setTimeout(k.hide,c.displayTime),k.should.show()?p.is(":visible")||k.show():k.hide()},destroy:function(){k.verbose("Destroying instance"),p.removeData(m).off(g),c.sticky&&b.off(g)},refresh:function(){k.debug("Refreshing cached calculations"),e=p.offset(),o=p.outerHeight(),t=b.outerWidth(),n=b.outerHeight(),i=b.offset()},show:function(){k.debug("Showing nag",c.animation.show),"fade"==c.animation.show?p.fadeIn(c.duration,c.easing):p.slideDown(c.duration,c.easing)},hide:function(){k.debug("Showing nag",c.animation.hide),"fade"==c.animation.show?p.fadeIn(c.duration,c.easing):p.slideUp(c.duration,c.easing)},onHide:function(){k.debug("Removing nag",c.animation.hide),p.remove(),c.onHide&&c.onHide()},stick:function(){var e;k.refresh(),"fixed"==c.position?(e=C(D).prop("pageYOffset")||C(D).scrollTop(),e=p.hasClass(l.bottom)?i.top+(n-o)-e:i.top-e,p.css({position:"fixed",top:e,left:i.left,width:t-c.scrollBarWidth})):p.css({top:r})},unStick:function(){p.css({top:""})},dismiss:function(e){c.storageMethod&&k.storage.set(c.storedKey,c.storedValue),k.hide(),e.stopImmediatePropagation(),e.preventDefault()},should:{show:function(){return c.persist?(k.debug("Persistent nag is set, can show nag"),!0):k.storage.get(c.storedKey)!=c.storedValue?(k.debug("Stored value is not set, can show nag",k.storage.get(c.storedKey)),!0):(k.debug("Stored value is set, cannot show nag",k.storage.get(c.storedKey)),!1)},stick:function(){return s=b.prop("pageYOffset")||b.scrollTop(),(r=p.hasClass(l.bottom)?n-p.outerHeight()+s:s)>e.top||"fixed"==c.position}},storage:{set:function(e,o){k.debug("Setting stored value",e,o,c.storageMethod),"local"==c.storageMethod&&D.store!==M?D.store.set(e,o):C.cookie!==M?C.cookie(e,o):k.error(u.noStorage)},get:function(e){return k.debug("Getting stored value",e,c.storageMethod),"local"==c.storageMethod&&D.store!==M?D.store.get(e):C.cookie!==M?C.cookie(e):void k.error(u.noStorage)}},event:{scroll:function(){a!==M&&clearTimeout(a),a=setTimeout(function(){k.should.stick()?w(k.stick):k.unStick()},c.lag)}},setting:function(e,o){if(C.isPlainObject(e))C.extend(!0,c,e);else{if(o===M)return c[e];c[e]=o}},internal:function(e,o){if(k.debug("Changing internal",e,o),o===M)return k[e];C.isPlainObject(e)?C.extend(!0,k,e):k[e]=o},debug:function(){c.debug&&(c.performance?k.performance.log(arguments):(k.debug=Function.prototype.bind.call(console.info,console,c.name+":"),k.debug.apply(console,arguments)))},verbose:function(){c.verbose&&c.debug&&(c.performance?k.performance.log(arguments):(k.verbose=Function.prototype.bind.call(console.info,console,c.name+":"),k.verbose.apply(console,arguments)))},error:function(){k.error=Function.prototype.bind.call(console.error,console,c.name+":"),k.error.apply(console,arguments)},performance:{log:function(e){var o,t;c.performance&&(t=(o=(new Date).getTime())-(H||o),H=o,z.push({Element:v,Name:e[0],Arguments:[].slice.call(e,1)||"","Execution Time":t})),clearTimeout(k.performance.timer),k.performance.timer=setTimeout(k.performance.display,100)},display:function(){var e=c.name+":",t=0;H=!1,clearTimeout(k.performance.timer),C.each(z,function(e,o){t+=o["Execution Time"]}),e+=" "+t+"ms",A&&(e+=" '"+A+"'"),1<S.size()&&(e+=" ("+S.size()+")"),(console.group!==M||console.table!==M)&&0<z.length&&(console.groupCollapsed(e),console.table?console.table(z):C.each(z,function(e,o){console.log(o.Name+": "+o["Execution Time"]+"ms")}),console.groupEnd()),z=[]}},invoke:function(n,e,o){var i,s,t,r=y;return e=e||O,o=v||o,"string"==typeof n&&r!==M&&(n=n.split(/[\. ]/),i=n.length-1,C.each(n,function(e,o){var t=e!=i?o+n[e+1].charAt(0).toUpperCase()+n[e+1].slice(1):n;if(C.isPlainObject(r[t])&&e!=i)r=r[t];else{if(r[t]!==M)return s=r[t],!1;{if(!C.isPlainObject(r[o])||e==i)return r[o]!==M&&(s=r[o]),!1;r=r[o]}}})),C.isFunction(s)?t=s.apply(o,e):s!==M&&(t=s),C.isArray(T)?T.push(t):T!==M?T=[T,t]:t!==M&&(T=t),s}};N?(y===M&&k.initialize(),k.invoke(F)):(y!==M&&k.destroy(),k.initialize())}),T!==M?T:this},C.fn.nag.settings={name:"Nag",debug:!1,verbose:!0,performance:!0,namespace:"Nag",persist:!1,displayTime:0,animation:{show:"slide",hide:"slide"},position:"fixed",scrollBarWidth:18,storageMethod:"cookie",storedKey:"nag",storedValue:"dismiss",sticky:!1,lag:0,context:D,error:{noStorage:"Neither $.cookie or store is defined. A storage solution is required for storing state",method:"The method you called is not defined."},className:{bottom:"bottom",fixed:"fixed"},selector:{close:".icon.close"},speed:500,easing:"easeOutQuad",onHide:function(){}}}(jQuery,window,void document);